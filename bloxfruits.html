<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2D Blox Fruits</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
        }

        #gameContainer {
            position: relative;
        }

        canvas {
            border: 2px solid black;
            background-color: #8ecae6; /* Sky blue for the game area */
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
    </div>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Set canvas dimensions
        canvas.width = 800;
        canvas.height = 600;

        // Player object
        const player = {
            x: 50,
            y: 50,
            width: 40,
            height: 40,
            speed: 5,
            color: 'green',
            score: 0
        };

        // Fruit object
        const fruits = [];
        const fruitSize = 20;

        // Enemy object
        const enemies = [];
        const enemySize = 40;
        const enemySpeed = 2;

        // Event listeners for player movement
        let keys = {};
        document.addEventListener('keydown', (e) => {
            keys[e.key] = true;
        });
        document.addEventListener('keyup', (e) => {
            keys[e.key] = false;
        });

        // Spawn fruits and enemies randomly
        function spawnFruit() {
            const x = Math.random() * (canvas.width - fruitSize);
            const y = Math.random() * (canvas.height - fruitSize);
            fruits.push({ x, y, width: fruitSize, height: fruitSize });
        }

        function spawnEnemy() {
            const x = Math.random() * (canvas.width - enemySize);
            const y = Math.random() * (canvas.height - enemySize);
            enemies.push({ x, y, width: enemySize, height: enemySize });
        }

        // Player movement
        function movePlayer() {
            if (keys['ArrowLeft'] && player.x > 0) {
                player.x -= player.speed;
            }
            if (keys['ArrowRight'] && player.x + player.width < canvas.width) {
                player.x += player.speed;
            }
            if (keys['ArrowUp'] && player.y > 0) {
                player.y -= player.speed;
            }
            if (keys['ArrowDown'] && player.y + player.height < canvas.height) {
                player.y += player.speed;
            }
        }

        // Check collisions with fruits
        function checkFruitCollision() {
            for (let i = 0; i < fruits.length; i++) {
                if (
                    player.x < fruits[i].x + fruits[i].width &&
                    player.x + player.width > fruits[i].x &&
                    player.y < fruits[i].y + fruits[i].height &&
                    player.y + player.height > fruits[i].y
                ) {
                    // Collect fruit
                    fruits.splice(i, 1);
                    player.score += 10;
                    i--;
                    spawnFruit(); // Spawn a new fruit
                }
            }
        }

        // Check collisions with enemies
        function checkEnemyCollision() {
            for (let i = 0; i < enemies.length; i++) {
                if (
                    player.x < enemies[i].x + enemies[i].width &&
                    player.x + player.width > enemies[i].x &&
                    player.y < enemies[i].y + enemies[i].height &&
                    player.y + player.height > enemies[i].y
                ) {
                    // Hit an enemy, reset the game
                    alert("You were hit by an enemy! Game Over.");
                    player.score = 0;
                    player.x = 50;
                    player.y = 50;
                    enemies.length = 0; // Remove all enemies
                    fruits.length = 0; // Remove all fruits
                    spawnFruit(); // Spawn a new fruit
                    spawnEnemy(); // Spawn a new enemy
                }
            }
        }

        // Move enemies
        function moveEnemies() {
            enemies.forEach(enemy => {
                const dx = player.x - enemy.x;
                const dy = player.y - enemy.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                if (distance < 100) {
                    const directionX = dx / distance;
                    const directionY = dy / distance;
                    enemy.x += directionX * enemySpeed;
                    enemy.y += directionY * enemySpeed;
                }
            });
        }

        // Draw the game elements
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear canvas

            // Draw player
            ctx.fillStyle = player.color;
            ctx.fillRect(player.x, player.y, player.width, player.height);

            // Draw fruits
            ctx.fillStyle = 'orange';
            fruits.forEach(fruit => {
                ctx.fillRect(fruit.x, fruit.y, fruit.width, fruit.height);
            });

            // Draw enemies
            ctx.fillStyle = 'red';
            enemies.forEach(enemy => {
                ctx.fillRect(enemy.x, enemy.y, enemy.width, enemy.height);
            });

            // Display score
            ctx.fillStyle = 'black';
            ctx.font = '20px Arial';
            ctx.fillText(`Score: ${player.score}`, 10, 30);
        }

        // Game loop
        function gameLoop() {
            movePlayer();
            moveEnemies();
            checkFruitCollision();
            checkEnemyCollision();
            draw();
            requestAnimationFrame(gameLoop); // Repeat the loop
        }

        // Start the game
        spawnFruit();
        spawnEnemy();
        gameLoop();
    </script>
</body>
</html>
