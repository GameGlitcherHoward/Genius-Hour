<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Geometry Dash: Glitch Apocalypse</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: black;
    }
    canvas {
      display: block;
    }
  </style>
</head>
<body>
  <canvas id="gameCanvas"></canvas>
  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    // Player
    const player = { x: 100, y: canvas.height - 150, width: 30, height: 30, color: "cyan", velocityY: 0, gravity: 1, jumpStrength: 20, isOnGround: false };

    // Platforms and Spikes
    const platforms = [{ x: 0, y: canvas.height - 100, width: canvas.width, height: 20 }];
    const spikes = [];
    const platformSpeed = 5;
    const spikeSpeed = 5;

    // Game Variables
    let isRunning = true;
    let score = 0;
    let frameCount = 0;

    // Key Listeners
    window.addEventListener("keydown", (event) => {
      if (event.key === " " && player.isOnGround) {
        player.velocityY = -player.jumpStrength;
        player.isOnGround = false;
      }
    });

    function spawnPlatform() {
      const width = Math.random() * 300 + 100; // Random width between 100 and 400
      platforms.push({ x: canvas.width, y: canvas.height - Math.random() * 200 - 50, width: width, height: 20 });
    }

    function spawnSpike() {
      const size = 30;
      spikes.push({ x: canvas.width, y: canvas.height - size - 100, width: size, height: size });
    }

    function update() {
      // Player movement
      player.velocityY += player.gravity;
      player.y += player.velocityY;

      // Check for collision with platforms
      player.isOnGround = false;
      platforms.forEach((platform) => {
        if (
          player.x < platform.x + platform.width &&
          player.x + player.width > platform.x &&
          player.y + player.height >= platform.y &&
          player.y + player.height <= platform.y + platform.height
        ) {
          player.velocityY = 0;
          player.y = platform.y - player.height;
          player.isOnGround = true;
        }
      });

      // Check for falling off the screen
      if (player.y > canvas.height) {
        isRunning = false;
      }

      // Move platforms and spikes
      platforms.forEach((platform, index) => {
        platform.x -= platformSpeed;
        if (platform.x + platform.width < 0) {
          platforms.splice(index, 1);
        }
      });

      spikes.forEach((spike, index) => {
        spike.x -= spikeSpeed;
        if (spike.x + spike.width < 0) {
          spikes.splice(index, 1);
        }

        // Check for collision with spikes
        if (
          player.x < spike.x + spike.width &&
          player.x + player.width > spike.x &&
          player.y < spike.y + spike.height &&
          player.y + player.height > spike.y
        ) {
          isRunning = false;
        }
      });

      // Spawn platforms and spikes periodically
      frameCount++;
      if (frameCount % 150 === 0) spawnPlatform();
      if (frameCount % 200 === 0) spawnSpike();

      // Update score
      score++;
    }

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw player
      ctx.fillStyle = player.color;
      ctx.fillRect(player.x, player.y, player.width, player.height);

      // Draw platforms
      platforms.forEach((platform) => {
        ctx.fillStyle = "white";
        ctx.fillRect(platform.x, platform.y, platform.width, platform.height);
      });

      // Draw spikes
      spikes.forEach((spike) => {
        ctx.fillStyle = "red";
        ctx.beginPath();
        ctx.moveTo(spike.x, spike.y + spike.height);
        ctx.lineTo(spike.x + spike.width / 2, spike.y);
        ctx.lineTo(spike.x + spike.width, spike.y + spike.height);
        ctx.closePath();
        ctx.fill();
      });

      // Draw score
      ctx.fillStyle = "white";
      ctx.font = "20px Arial";
      ctx.fillText(`Score: ${score}`, 10, 30);
    }

    function gameLoop() {
      if (isRunning) {
        update();
        draw();
        requestAnimationFrame(gameLoop);
      } else {
        ctx.fillStyle = "red";
        ctx.font = "50px Arial";
        ctx.fillText("Game Over", canvas.width / 2 - 150, canvas.height / 2);
        ctx.fillText(`Final Score: ${score}`, canvas.width / 2 - 150, canvas.height / 2 + 60);
      }
    }

    gameLoop();
  </script>
</body>
</html>
